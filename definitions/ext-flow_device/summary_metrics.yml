ipAddress:
  title: IP Address
  unit: STRING
  tag:
    key: device_ip

flowType:
  title: Flow Type
  unit: STRING
  tag:
    key: flow_type

sources:
  title: Unique Sources
  unit: COUNT
  queries:
    kentik/netflow-events:
      select: uniqueCount(src_addr)
      from: KFlow
      where: "provider = 'kentik-flow-device'"
      eventId: entity.guid

destinations:
  title: Unique Destinations
  unit: COUNT
  queries:
    kentik/netflow-events:
      select: uniqueCount(dst_addr)
      from: KFlow
      where: "provider = 'kentik-flow-device'"
      eventId: entity.guid

packetsPerSecond:
  title: Average Packets/sec
  unit: COUNT
  queries:
    kentik/netflow-events:
      select: count(*) * latest(sample_rate)
      from: KFlow
      where: "provider = 'kentik-flow-device'"
      eventId: entity.guid
